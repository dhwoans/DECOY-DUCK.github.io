---
layout: post
title: DNS
subtitle: Domain Name System 
banner:
  image: https://kinsta.com/wp-content/uploads/2018/05/what-is-dns.png
  opacity: 0.618
  background: "#000"
  heading_style: "font-size: 4.25em; font-weight: bold; "
author: 오재문
categories: web
tags: web,DNS
comments: true

---

웹브라우저는 URL을 해독하고 HTTP 메시지를 만드는 기능은 있지만 네트워크로 전송하는 기능은 없기 때문에 운영체제에게 네트워크 전송을 요청한다. 이때 도메인명을 보내는 것이 아니라 IP주소로 메세지 받을 상대를 지정해야 한다. 때문에 도메인명으로 IP주소를 조회하는 기능이 필요하다.

## 도메인명과 IP 주소 구분 이유

TCP/IP의 네트워크는 IP 주소로 통신 상대를 지정하므로 IP 주소를 모르면 상대에게 메시지를 전달할 수 없다. 이 상황은 전화를 걸때 상대의 전화번호가 필요한 것과 비슷하다. 도메인대신 IP 주소를 사용해도 괜찮겠지만 숫자는 인간 친화적이지 못해 기억하기 어렵다. 반대로 IP 주소 체계를 도메인으로 변경한다면 255바이트까지의 대역폭을 가지게 되므로 라우터에 가중되는 부하가 심해진다. 그리하여 인간은 도메인을 사용하고 이를 IP 주소 체계로 변환하는 과정을 거치는 것이 합리적인데 그 원리가 DNS이다.

## Browser와 DNS 서버 송수신


Browser 는 domain name 에 해당하는 IP주소를 받기 위해 DNS Server에 요청을 보내고 DNS Server는 그에 대한 응답 메시지를 Browser에 보낸다. 

👉 [Is using the IP address faster than using the domain name?](https://stackoverflow.com/questions/15964050/is-using-the-ip-address-faster-than-using-the-domain-name) 


## Socket 라이브러리


도메인명을 IP 주소로 변환하기 위해서는 DNS 서버에 이를 조회하여야 하는데, 이때 DNS 서버에 대해 클라이언트로 동작하는 것을 DNS 리졸버 또는 단순히 리졸버라고 부른다. 그리고 DNS의 원리를 사용하여 IP 주소를 조사하는 것을 name resolution 이라고 하는데, 이 리졸루션을 실행하는 것을 리졸버(resolver)이다. 리졸버의 실체는 Socket 라이브러리에 들어있는 부품화한 프로그램이다. 고로 도메인명에서 IP 주소를 조사할 때 브라우저는 Socket 라이브러리의 리졸버를 이용한다.

### DNS 서버 구성

사내 네트워크처럼 웹 서버나 메일 서버의 수가 제한되어 있으면 정보를 1대의 DNS 서버에 등록할 수 있다. 하지만 인터넷에는 막대한 수의 서버가 있고 이를 1대의 DNS 서버에 등록하는 것은 불가능하다.

### 도메인의 계층

인터넷 DNS 서버는 수만 대나 있으므로 닥치는 대로 뒤지면서 다닐 수는 없다. 그래서 다음과 같은 방법을 고안했다. 먼저 하위의 도메인을 담당하는 DNS 서버의 IP주소를 그 상위 DNS 서버에 등록한다. 그 상위 DNS 서버는 상위 DNS 서버로 차례대로 등록한다.

우선 가까운 DNS Server(클라이언트의 TCP/IP 설정 항목에 설정되어 있다.nslookup을 통해서도 알수 있다.)를 통해 ip주소를 조회한다. 여기는 매번 상위 DNS Server부터 조회해서 ip를 받아오는 것은 매우 비효율적이기 때문에 캐싱되어 있다. 만약 등록되어 있지 않다면 도메인의 계층을 위에서 아래로 따라간다.